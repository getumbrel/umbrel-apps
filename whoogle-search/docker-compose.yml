version: "3.7"

services:
  app_proxy:
    environment:
      APP_HOST: $APP_WHOOGLE_SEARCH_IP
      APP_PORT: $APP_WHOOGLE_SEARCH_PORT
      PROXY_AUTH_ADD: "false"

  web:
    image: benbusby/whoogle-search:latest@sha256:5b6922affd5b5d6502d3d3dd91ab3d3c22f31f89af2e67868d5de62631aa4762
    restart: on-failure
    stop_grace_period: 1m
    user: "927:927"
    environment:
      WHOOGLE_CONFIG_URL: ${DEVICE_HOSTNAME}:$APP_WHOOGLE_SEARCH_PORT
      WHOOGLE_TOR_SERVICE: '1'
      WHOOGLE_PROXY_LOC: "socks://$TOR_PROXY_IP:$TOR_PROXY_PORT"
      EXPOSE_PORT: $APP_WHOOGLE_SEARCH_PORT
    networks:
      default:
        ipv4_address: $APP_WHOOGLE_SEARCH_IP
