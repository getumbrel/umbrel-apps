version: "3.9"

services:
  app_proxy:
    environment:
      APP_HOST: stalwart_mail-server_1
      APP_PORT: 8080
      PROXY_AUTH_ADD: "false"

  mail-server:
    image: stalwartlabs/stalwart:v0.13.2@sha256:e682677f83ebb44632e41684db293fd46db8ff94487cef3b894b5c668b448716
    ports:
      - 25:25
      - 143:143
      - 465:465
      - 587:587
      - 993:993
      - 4190:4190
    volumes:
      - ${APP_DATA_DIR}/data:/opt/stalwart
    restart: on-failure
