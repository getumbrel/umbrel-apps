version: '3.7'

services:
  app_proxy:
    environment:
      APP_HOST: samba_homepage_1
      APP_PORT: 9445
    container_name: samba_homepage_app_proxy_1

  apache:
    image: >-
      httpd:2.4.59@sha256:10182d88d7fbc5161ae0f6f758cba7adc56d4aae2dc950e51d72c0cf68967cea
    container_name: samba_homepage_1
    restart: on-failure
    volumes:
      - ${APP_DATA_DIR}/data:/usr/local/apache2/htdocs
      - ${APP_DATA_DIR}/data/httpd.conf:/usr/local/apache2/conf/httpd.conf

  server:
    image: >-
      dockurr/samba:4.20.1@sha256:9a57887c0be1242ee2e1381653619a656820e1aee8e271885662d04c2c367be8
    container_name: samba_server_1
    restart: on-failure
    environment:
      USER: umbrel
      PASS: changeme
    ports:
      - '445:445'
    volumes:
      - ${UMBREL_ROOT}/data/smb.conf:/etc/samba/smb.conf
      - ${UMBREL_ROOT}/data/storage:/storage
