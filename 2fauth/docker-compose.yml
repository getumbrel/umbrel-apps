version: "3.7"

services:
  app_proxy:
    environment:
      APP_HOST: 2fauth_web_1
      APP_PORT: 8000
      PROXY_AUTH_ADD: "false" #has it's own auth

  web:
    image: 2fauth/2fauth:5.0.4@sha256:63e844dbefe75decd819c61e454ac2a93f8f936e1d6b737f3d26dc5a00d01a45
    restart: on-failure
    stop_grace_period: 1m
    volumes:
      - ${APP_DATA_DIR}/data/2fauth:/2fauth
    environment:
      - APP_KEY=${APP_2FAUTH_APP_KEY} # data encryption
      - APP_URL=http://${DEVICE_DOMAIN_NAME}:8235
      - ASSET_URL=http://${DEVICE_DOMAIN_NAME}:8235