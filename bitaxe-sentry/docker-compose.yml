services:
  app_proxy:
    environment:
      APP_HOST: bitaxe-sentry_web_1
      APP_PORT: 7070
      
  sentry:
    image: zachprice105/bitaxe-sentry:v0.3.1@sha256:5fe18ec95cdbbb4076eca8b28d3ce2b66f7512daa4de78a9e24ea12259b6cd0b
    restart: on-failure
    stop_grace_period: 1m
    volumes:
      - ${APP_DATA_DIR}/data:/app/data
    environment:
      DB_PATH: "/app/data/sentry.db"
    
  web:
    image: zachprice105/bitaxe-sentry:v0.3.1@sha256:5fe18ec95cdbbb4076eca8b28d3ce2b66f7512daa4de78a9e24ea12259b6cd0b
    restart: on-failure
    stop_grace_period: 1m
    volumes:
      - ${APP_DATA_DIR}/data:/app/data
    command: uvicorn bitaxe_sentry.sentry.webapp:app --host 0.0.0.0 --port 7070
    depends_on:
      - sentry